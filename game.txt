Black mirror, sciami di api assassine, reti neurali e algoritmi genetici ...

Spoiler alert: questo sarà un post nerdissimo, forse il più nerd che abbia mai scritto ...

Diverso tempo fa mi sono intrippato a manetta di una mini serie televisiva chiamata Black Mirror. La storia sarebbe lunga, ma per farvela brevissima vi dirò che questa serie parte da questioni tecnologiche del mondo di oggi (quindi realissime, non immaginarie o futuristiche) e ne mostra il lato oscuro, cioè cosa potrebbe accadere se una certa tecnologia fosse usata al di là degli scopi per i quali è stata inventata.
Ebbene c'era questo episodio dove alcuni ricercatori per combattere il fatto (vero) che le api stanno morendo, si erano inventati di usare sciami di api robotiche (anche queste vere), guidate da intelligenza artificiale (anche questa vera), che svolgevano egregiamente il lavoro delle api vere, risolvendo il problema delle terribili conseguenze legate alla morte delle api.
Fin qui tutto bene ... fino a quando qualcuno si è impossessato del controllo della api robotiche, riprogrammandole per i propri loschi scopi, cioè banalmente uccidere in modo atroce chi non gli stava simpatico.

Bene, allora mi sono chiesto se fossi riuscito a programmare uno sciame di api robotiche per conquistare il mondo ... ed il risultato è quello che vedrete nei video qui sotto.

Fatemi spiegare, altrimenti guardando solo i video non ci capireste molto. L'idea è questa. Il mondo qui è un toroide, nel senso che come nel caso di pacman, oggetti che escono dallo schermo da un lato riappaiono dall'altro. Questo solo per semplificarmi la vita e rendere le cose un po' più veloci (ma non impatta sul mio piano di conquista del mondo).
I puntini bianchi sono le api assassine. 
I puntini rossi sono le sfortunate prede.
Nel mondo ci sono sempre 10 prede. Esse nascono a caso e si muovono di moto vario, con accelerazioni casuali entro un certo intervallo. La riga che sembra un naso ha una lunghezza proporzionale alla velocità delle prede ed ha un verso pari al verso di movimento delle prede in quell'istante. Le prede vengono mangiate dalle api e quando una preda viene mangiata, un'altra appare a caso nel mondo. Le prede sono completamente stupide e ignare del mondo che le circonda.
Fino qui niente di speciale.
La cosa speciale sono le api.

Le api si muovono come le prede (moto vario), ma questa volta, le accelerazioni istantanee che ricevono non sono a caso come per le prede. Esse sono il risultato di ciò che il loro cervello dice loro di fare, esattamente come capita per gli esseri viventi.
Il cervello delle api è una rete neurale artificiale (ogni ape ha il suo cervello ovviamente), che funziona in modo del tutto simile alle reti neurali del cervello che conosciamo. Nella parte alta dello schermo ne vedete un esempio, con le sinapsi che si colorano quando scattano (verde positive e rosso negative). Ci sono tre neuroni d'ingresso, 8 + 4 neuroni nascosti (intermedi) e due neuroni d'uscita. L'uscita dei neuroni d'uscita è l'accelerazione lungo x e lungo y rispettivamente che verrà data all'ape. Ogni ape è dotata di tre sensori (come noi siamo dotati di occhi, orecchie, ecc ...). Questi misurano la distanza della preda più vicina lungo x e lungo y dall'ape e la differenza angolare tra la velocità della preda vicina e quella dell'ape. Senza spingermi troppo oltre vi dirò solo che le connessioni tra i neuroni sono rappresentate da numeri (i pesi) che moltiplicano il valore in ingresso per dare il valore in uscita dalla connessione. Infine ogni neurone implementa la somma dei valori in ingresso elaborata con una tangente iperbolica per dare il valore d'uscita.
Ora, all'inizio dei tempi, le api hanno tutte cervelli completamente a caso. In altre parole i pesi sono inizializzati come numeri casuali.
Quindi ogni ape, col suo cervello casuale, osserva il mondo attorno a sè, misura con i suoi sensori, elabora le misure con la propria rete neurale, determina le accelerazioni e si muove. Diciamo che si muove male. Molto male. Come si vede nel primo video, che rappresenta le nostre api appena nate.

Ora, se fate un ultimo sforzo, vi parlo di come le api si riproducono. No, no. Non parlo della storia delle api e dei fiori ... quella è roba vecchia ...
Dunque, sul lato destro dello schermo ci sono due indicatori per ogni ape. L'indicatore arancione è la vita di ogni ape. Quando l'indicatore arancione arriva al fondo un'ape muore ed un'altra nasce. L'indicatore verde, invece, rappresenta l'energia dell'ape e cresce al crescere del numero di prede che l'ape mangia. Più passa il tempo e più l'energia scende. Più ha energia e più si allunga la sua vita.
Questo meccanismo è il cuore del programma che ho scritto. L'unico modo che un'ape ha per rimanere in vita a lungo è quello di mangiare prede il più velocemente possibile. Se non fa così, muore. Un po' crudele, ma efficace.
Si perchè oltre a mangiare, le api, come tutti gli esseri viventi, si accoppiano e si riproducono. E come fanno ? Beh, diciamo che lo fanno in un modo poco divertente, al contrario di noi. Quando un'ape muore, quella che nasce al suo posto lo fa come risultato dell'accoppiamento di altre due api nello sciame. Queste sono scelte a caso, e la probabilità di essere scelti per accoppiarsi è proporzionale alla propria energia. Proprio come in natura. Le due api che si accoppiano creano una nuova ape il cui patrimonio genetico (i pesi del loro cervello) è preso dai genitori. Proprio come in natura (o quasi). Infine, con bassa probabilità, qualcuno di questi pesi subisce una mutazione genetica, cambiando valore secondo uno tra quattro meccanismi che non vi sto a dire (visto che di dettagli ne ho già detti fin troppi). Ah, le nuove api hanno un colore diverso dalle precedenti vicino al colore del genitore che le ha generate.
Quello qui descritto è il fondamento degli algoritmi (di ottimizzazione) genetici ed ha il preciso scopo di selezionare il miglior cervello che meglio si adatta allo scopo del gioco: mangiare il maggior numero di prede possibili, il più in fretta possibile.

Ultimo dettaglio, lo giuro. Per rendere le cose un pochino più interessanti, ho deciso che una preda può essere mangiata solo se l'ape gli arriva di fronte. Quindi le api devono muoversi con largo anticipo, predire come si muovono le prede e pararsi di fronte a queste per riuscire a mangiare. Ora, la cosa che mi ha lasciato piuttosto interdetto, è che io questa cosa mica gliel'ho spiegata alle api. Mi sono limitato ad evitare che potessero mangiare se non lo facevano come volevo io.

Bene, il risultato che ho ottenuto dopo mezz'oretta di simulazione è quello che vedete nel secondo video: api voracissime, perfettamente in grado di predire il movimento delle prede, che hanno sviluppato un'interessante tecnica del "giretto" per riuscire a lanciarsi sulle prede e a mangiarle di fronte.

E adesso scusate, ma devo andare a conquistare il mondo ...